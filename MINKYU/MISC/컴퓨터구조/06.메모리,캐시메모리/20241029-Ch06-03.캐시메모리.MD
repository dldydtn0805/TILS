# 컴퓨터구조
## Ch06. 메모리와 캐시메모리
### 06-03. 캐시 메모리
출처 : [강민철 - 개발자를 위한 컴퓨터공학 1 : 혼자 공부하는 컴퓨터구조 + 운영체제](https://www.inflearn.com/course/%ED%98%BC%EC%9E%90-%EA%B3%B5%EB%B6%80%ED%95%98%EB%8A%94-%EC%BB%B4%ED%93%A8%ED%84%B0%EA%B5%AC%EC%A1%B0-%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C)

### 1. 저장 장치 계층 구조
캐시 메모리는 어떻게 탄생한걸까?
- 저장 장치의 계층 구조를 파악하면 알 수 있다

저장 장치의 일반적인 명제
1. CPU와 가까이 위치한 저장 장치는 빠르고, 멀리 있는 저장 장치는 느리다
- CPU와의 물리적인 거리가 가까운 저장장치일수록 빠르다
2. 속도가 빠른 저장 장치는 저장 용량이 작고, 가격이 비싸다
- 속도는 저장 용량과 반비례하고, 가격과 비례한다

결론적으로, CPU와 가까움 -> 속도 빠름 -> 비싸고 저장 용량이 작음
- 레지스터 : CPU 내부에 존재(가장 가까움)
- 메모리(RAM) : 레지스터보다는 CPU와 거리가 있음
- USB 메모리 : 보조기억장치(가장 멈)

저장 장치 계층 구조(Memory Hierarchy) : 컴퓨터가 사용하는 저장 장치들을 <CPU와 얼마나 가까운가>를 기준으로 하여 계층적으로 나타낸 구조
- 지금까지 배운 내용을 기반으로 한 저장 장치 계층 구조 : 레지스터 -> 주기억장치 -> 보조기억장치

### 2. 캐시 메모리
CPU는 프로그램을 실행하는 과정에서 빈번하게 메모리에 접근해야 함
- 근데... 레지스터에 비해 메모리에 접근하는 속도는 느리다며??
- 그러면 CPU 연산속도가 아무리 빨라도 메모리 접근 속도가 그걸 따라가지 못한다면 소용이 없는거네?
- 그렇다면.... 그 사이에 특별한 저장 장치를 만들어내자!

캐시 메모리(Cache Memory) : CPU와 메모리 사이에 위치한 SRAM 기반의 저장 장치
- CPU가 사용하려는 일부 데이터를 메모리로부터 미리 가지고 와서 활용하기 위해 사용
- CPU와 가까운 순서를 기준으로 L1, L2, L3가 존재
    - L1 캐시(Level 1 Cache)와 L2 캐시(Level 2 Cache) : CPU 내보에 위치
    - L3 캐시(Level 3 Cache) : CPU 외부에 존재
- 멀티 코어 프로세서일 경우, L1과 L2는 각 코어별로 존재, L3는 여러 코어가 공유
- 조금이라도 접근 속도를 빠르게 하기 위해 L1를 두 가지(L1I, L1D)로 분리한 분리형 캐시(Split Cache)도 존재
    - L1I (Level 1 Instruction Cache Memory): 명령어만을 저장
    - L1D (Level 1 Data Cache Memory): 데이터만을 저장
- 용량 : 레지스터 < 캐시 메모리 < 메모리

지금까지 배운 내용을 기반으로 한 저장 장치 계층 구조(CPU와 가까운 순)
1. CPU 내부
- 레지스터
- L1
- L2
2. CPU 외부
- L3
- 메모리
- 보조기억장치

#### 참조 지역성
앞서 말한 내용
- CPU가 메모리에 접근하는 빈도를 줄이기 위해 캐시 메모리 등장
- 용량은 메모리보다 작음

Q. 용량이 메모리보다 작다는건, 한 번에 모든 데이터를 미리 가져올 수는 없는거네??
- 캐시 메모리가 저장하는 건 도대체 뭐야?

**캐시 메모리는 참조 지역성의 원리에 따라 CPU가 사용할 법한 대상을 예측하여 저장한다**

참조 지역성의 원리(Locality of Reference) : CPU가 메모리에 접근할 때의 주된 경향을 바탕으로 만들어진 원리
1. 시간 지역성 : CPU는 최근 접근했던 메모리 공간에 다시 접근하려는 경향이 있다
2. 공간 지역성 : CPU는 접근한 메모리 공간 근처를 접근하려는 경향이 있다

**우리가 사용하는 컴퓨터는 약 85% ~ 90%로 예측성공률을 가진다**

1. 캐시 히트(Cache Hit) : 자주 사용될 것으로 예측하여 캐시 메모리에 저장한 데이터가 실제로 CPU에서 활용되는 경우
2. 캐시 미스(Cache Miss) : 자주 사용될 것으로 예측하여 캐시 메모리에 저장한 데이터가 실제로는 CPU에서 활용되지 않는 경우
3. 캐시 적중률(Cache Hit Ratio) : 캐시가 히트되는 비율(= cache hit / (cache hit + cache miss))
- 캐시 적중률이 높을수록 메모리 접근 횟수를 줄일 수 있다