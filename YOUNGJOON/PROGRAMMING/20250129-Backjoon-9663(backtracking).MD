# 코드

```c++
#include <iostream>
#include <vector>
#include <cmath>

#define pll pair<int, int>

using namespace std;

int N;
vector<int> board(15, 0);
int result = 0;

bool checking(int low)
{
    for (int i=0; i<low; ++i) {
        int one = abs(i - low);
        int two = abs(board[i] - board[low]);
        if (board[i] == board[low] || one == two) return true;
    }

    return false;
}

void set_queen(int x)
{
    if (x == N) {
        result++;
        return;
    }
    
    for (int j=0; j<N; ++j) {
        
        board[x] = j;
        
        if (!checking(x)) {
            set_queen(x+1);
        }
    }
    
    return;
}

int main()
{
    cin >> N;
    
    set_queen(0);
    
    cout << result;

    return 0;
}

```



> ## 문제
>
> N-Queen 문제는 크기가 N × N인 체스판 위에 퀸 N개를 서로 공격할 수 없게 놓는 문제이다.
>
> N이 주어졌을 때, 퀸을 놓는 방법의 수를 구하는 프로그램을 작성하시오.
>
> ## 입력
>
> 첫째 줄에 N이 주어진다. (1 ≤ N < 15)
> ## 해설
> 
> 문제를 처음 봤을 때 워낙 유명한 백트래킹 문제라... 백트래킹으로 풀기로 했다. N\*N 전체를 순회하면서 한 위치에 퀸을 두고 퀸의 위치를 담는 배열에 퀸의 좌표를 넣은 후 다음 퀸을 두려고 넘어갔다. 그런데 이때 순회를 N\*N으로 해버리니까 문제가 발생했다...
> 
> 어차피 퀸이라는 건 한 행에 1개밖에 들어가지 못하니 N번의 순회로 가능했다.
> 
> 그래서 현재 행에서 N만큼 순회하여 위치를 지정하고 현재 저장된 퀸의 위치에서 공격당하는 위치인지 판단하고 공격 받지 않으면 진행, 받으면 리턴하게하였다.
> 
> 그런데 또 시간초과가 났다.. 아무래도 대각선에 퀸이 존재하는지 유무를 판단하는게 너무 오래걸렸던 것 같다.
> 
> - 기존에는 현재 위치에서 위쪽 두방향 대각선으로 하나씩 이동하면서 퀸의 유무를 파악했는데 이는 너무 시간이 많이 들었다.
> 
> 그래서 다음 방식으로는 visited라는 2차원 배열을 인자로 넣어 가능한 위치를 체크하여 보내주기로 했다. 그런데 이 방법 또한 체크하는데 시간, 배열을 선언하는데 시간, 오히려 더 안좋은 방법이었다.
> 
> 아아.. 결국 그래서 유명한 문제인데도 블로그를 참고하고 말았다..
> 
> 대각선을 판단하는 아주 획기적인 방법이 있는데 아래와 같다.
> 
> ```
> 어떠한 좌표 n, m과 다른 좌표 x, y가 있다면
> abs(n - x) == abs(m - y)가 성립한다면 두 좌표는 같은 대각선 상 위에 존재하는 좌표이다.
> ```
> 
> 이 방법을 쓰면 단 두 번의 연산으로 대각선의 존재 여부를 파악할 수 있었다.....
> 
>이렇게 하니까 시간이 많이 줄어들었는데, 더 시간을 줄일 필요가 있었다...
> 
>퀸을 배치한 좌표를 배열에 저장하는 것이 아니라 1차원 배열에 각 인덱스 값이 열의 번호, 인덱스 안에 저장 된 값이 행의 번호로 보는 것이었다.
> 
>이렇게 하면 열의 번호를 따로 저장하지 않아도 되고, 행의 번호를 살펴보는데도 용이하기 때문에 상당히 뛰어난 효율의 방법이었다.
> 
>이렇게 해서 현재 행보다 이전의 행들을 모두 비교하여 수직선상에 퀸이 있는지와, 대각선상에 퀸이 있는지를 판별하여 퀸의 자리 선정을 따져주었다.
> 
>흠... 백트래킹인걸 알았음에도 불구하고 혼자 힘으로 못풀었다... 으으... 백트래킹은 사실 그냥 가지만 치는게 중요한게 아니라 이렇게 최적화 방법도 같이 따지는 경우가 많은 것 같아서... 문제를 많이 풀어봐야겠다 흑흑...
