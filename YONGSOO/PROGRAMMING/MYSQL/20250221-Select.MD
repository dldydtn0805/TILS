```sql
#https://school.programmers.co.kr/learn/courses/30/lessons/273711

/*해설
ITEM_A -> ITEM_B와 같이 업그레이드가 가능할때 ITEM_A를 PARENT 아이템이라 한다

PARENT가 없는 아이템은 ROOT 아이템이다

아이템의 희귀도가 RARE인 아이템들의

모든 다음 업그레이드 아이템의 

ITEM_ID / ITEM_NAME / RARITY를 출력하세요

결과는 아이템 ID를 기준으로 내림차순 정렬하세요
*/

/*입력
// ITEM_INFO
ITEM_ID	ITEM_NAME	RARITY	PRICE
0	ITEM_A	RARE	10000
1	ITEM_B	RARE	9000
2	ITEM_C	LEGEND	11000
3	ITEM_D	RARE	10000
4	ITEM_E	RARE	12000

// ITEM_TREE
ITEM_ID	PARENT_ITEM_ID
0	NULL
1	0
2	0
3	1
4	1
*/

/*출력
ITEM_ID	ITEM_NAME	RARITY
4	ITEM_E	RARE
3	ITEM_D	RARE
2	ITEM_C	LEGEND
1	ITEM_B	RARE
*/

SELECT B.ITEM_ID, 
    (SELECT ITEM_NAME
     FROM ITEM_INFO
     WHERE ITEM_ID = B.ITEM_ID
    ) AS ITEM_NAME, 
    (SELECT RARITY
     FROM ITEM_INFO
     WHERE ITEM_ID = B.ITEM_ID
    ) AS RARITY
FROM ITEM_INFO AS A
JOIN ITEM_TREE AS B
ON A.ITEM_ID = B.PARENT_ITEM_ID
WHERE A.RARITY = "RARE"
ORDER BY B.ITEM_ID DESC
```