## Source
https://school.programmers.co.kr/learn/courses/30/lessons/301650

## Commentary 

3세대 대장균의 ID를 출력하는 SQL문을 작성하세요

결과는 대장균의 ID에 대해 오름차순 정렬하세요


----

PARENT_ID 가 NULL인 개체가 1세대,

각 1세대에서 분화된 것들이 2세대, 

2세대에서 분화된 것이 3세대, ....


이런식이다. 

따라서, 1세대를 구하고, 2세대를 구한 뒤, 

3세대를 구하면 될 것 같은데 ? 

---

1세대 구하는 것은 서브쿼리로 하면 되고, 

해당 쿼리와 테이블을 조인해서 2세대를 만들고, 

이것을 또 조인해서 3세대를 만들면 되는것 아닌가 ? 

---

정확히 처음 생각한대로 구현하니 맞았다 굿 

## Input

```
//ECOLI_DATA

ID	PARENT_ID	SIZE_OF_COLONY	DIFFERENTIATION_DATE	GENOTYPE
1	NULL	10	2019/01/01	5
2	NULL	2	2019/01/01	3
3	1	100	2020/01/01	4
4	2	16	2020/01/01	4
5	2	17	2020/01/01	6
6	4	101	2021/01/01	22
7	3	101	2022/01/01	23
8	6	1	2022/01/01	27
```

## Output
```
ID
6
7
```

## Source Code

```sql


WITH GET_SECOND_GENERATION AS (
    SELECT A.ID
    FROM ECOLI_DATA AS A
    JOIN (
        SELECT ID
        FROM ECOLI_DATA
        WHERE PARENT_ID IS NULL
    ) AS B
    ON A.PARENT_ID = B.ID
)

SELECT A.ID
FROM ECOLI_DATA AS A
JOIN GET_SECOND_GENERATION AS B
ON A.PARENT_ID = B.ID
ORDER BY A.ID ASC
```

