## Source

https://school.programmers.co.kr/learn/courses/30/lessons/132204


## Commentary

PATIENT, DOCTOR 그리고 APPOINTMENT 테이블에서 2022년 4월 13일 취소되지 않은 흉부외과 CS 진료 예약 내역을 조회하세요

진료예약번호, 환자이름, 환자번호, 진료과코드, 의사이름, 진료예약일시 항목이 출력되도록 작성하세요

결과는 진료예약일시를 기준으로 오름차순 정렬하세요

----

2022년 4월 13일 취소되지 않은 CS 진료 내역을 조회해야한다

CS인지 여부와 날짜, 취소여부는 APPOINTMENT 테이블에 모두 있다

따라서 이 테이블의 의사ID, 환자ID 를 가지고 PATIENT 테이블과 DOCTOR 테이블과 조인한다면 ? 

출력하면 끝! 


## Input

```
//PATIENT
PT_NO	PT_NAME	GEND_CD	AGE	TLNO
PT22000019	바라	W	10	01079068799
PT22000043	오스왈드	M	68	01031294124
PT22000052	제니	W	60	NULL
PT22000071	몬몬	M	31	01076489209
PT22000097	슈가	M	19	NULL

//DOCTOR
DR_NAME	DR_ID	LCNS_NO	HIRE_YMD	MCDP_CD	TLNO
루피	DR20090029	LC00010001	2009-03-01	CS	01085482011
니모	DR20200012	LC00911162	2020-03-01	CS	01089483921
핑크퐁	DR20140011	LC00082201	2014-03-01	NP	01098428957
젤라비	DR20160031	LC00340327	2016-11-01	OB	01023981922
토리	DR20190129	LC00099911	2019-03-01	NS	01058390758

//APPOINTMENT
APNT_YMD	APNT_NO	PT_NO	MCDP_CD	MDDR_ID	APNT_CNCL_YN	APNT_CNCL_YMD
2022-04-13 12:30:00.000000	42	PT22000071	CS	DR20090029	N	NULL
2022-04-13 15:30:00.000000	43	PT22000019	CS	DR20200012	N	NULL
2022-04-13 09:00:00.000000	46	PT22000043	CS	DR20090029	N	NULL
2022-07-09 11:00:00.000000	74	PT22000042	NP	DR20100011	N	NULL
2022-12-13 12:30:00.000000	110	PT22000097	NP	DR20160011	Y	2022-12-03
```

## Output
```
APNT_NO	PT_NAME	PT_NO	MCDP_CD	DR_NAME	APNT_YMD
46	오스왈드	PT22000043	CS	루피	2022-04-13 09:00:00.000000
42	몬몬	PT22000071	CS	루피	2022-04-13 12:30:00.000000
43	바라	PT22000019	CS	니모	2022-04-13 15:30:00.000000
```

## Source Code 

```sql

SELECT A.APNT_NO, P.PT_NAME, P.PT_NO, D.MCDP_CD, D.DR_NAME, A.APNT_YMD
FROM APPOINTMENT AS A
JOIN DOCTOR AS D
ON A.MDDR_ID = D.DR_ID
JOIN PATIENT AS P
ON A.PT_NO = P.PT_NO
WHERE YEAR(A.APNT_YMD) = 2022 AND
    MONTH(A.APNT_YMD) = 4 AND
    DAY(A.APNT_YMD) = 13 AND
    A.MCDP_CD = "CS" AND
    A.APNT_CNCL_YMD IS NULL
ORDER BY A.APNT_YMD ASC

```