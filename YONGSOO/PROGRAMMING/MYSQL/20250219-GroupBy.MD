```sql
#https://school.programmers.co.kr/learn/courses/30/lessons/284527

/*해설

2022년도 평가 점수는 상, 하반기 점수의 합을 의미합니다.
2022년도 평가 점수가 가장 높은 사원들의 점수 / 사번 / 성명 / 직책 / 이메일을 조회하세요

여기서 새롭게 알게된 것은, 

정렬 후 limit을 걸어서 원하는 행만 출력할 수 있다는 점이다.
*/

/*입력
//HR_DEPARTMENT
DEPT_ID	DEPT_NAME_KR	DEPT_NAME_EN	LOCATION
D0001	법무팀	Law Dep	그렙타워 4층
D0002	인사팀	Human resources	그렙타워 4층
D0003	총무팀	General Affairs	그렙타워 4층

//HR_EMPLOYEES
EMP_NO	EMP_NAME	DEPT_ID	POSITION	EMAIL	COMP_TEL	HIRE_DATE	SAL
2017002	정호식	D0001	팀장	hosick_jung@grepp.com	031-8000-1101	2017-03-01	65000000
2018001	김민석	D0001	팀원	minseock_kim@grepp.com	031-8000-1102	2018-03-01	60000000
2019001	김솜이	D0002	팀장	somi_kim@grepp.com	031-8000-1106	2019-03-01	60000000
2020002	김연주	D0002	팀원	yeonjoo_kim@grepp.com	031-8000-1107	2020-03-01	53000000
2020005	양성태	D0003	팀원	sungtae_yang@grepp.com	031-8000-1112	2020-03-01	53000000

//HR_GRADE
EMP_NO	YEAR	HALF_YEAR	SCORE
2017002	2022	1	92
2018001	2022	1	89
2019001	2022	1	94
2020002	2022	1	90
2020005	2022	1	92
2017002	2022	2	84
2018001	2022	2	89
2019001	2022	2	81
2020002	2022	2	91
2020005	2022	2	81
*/

/*출력
*/

SELECT SUM(A.SCORE) AS SCORE, 
    A.EMP_NO AS EMP_NO,
    B.EMP_NAME AS EMP_NAME,
    B.POSITION AS POSITION,
    B.EMAIL AS EMAIL
FROM HR_GRADE AS A
JOIN HR_EMPLOYEES AS B
ON A.EMP_NO = B.EMP_NO
GROUP BY A.EMP_NO 
ORDER BY SCORE DESC
LIMIT 1



```

```sql
#https://school.programmers.co.kr/learn/courses/30/lessons/284527

/*해설
또한 아래처럼 서브쿼리를 사용해서 문제 해결 가능하다는 것도 알았다.

WITH 구문으로 가상 테이블을 만들 수 있다는 것이다. 
*/

/*입력
//HR_DEPARTMENT
DEPT_ID	DEPT_NAME_KR	DEPT_NAME_EN	LOCATION
D0001	법무팀	Law Dep	그렙타워 4층
D0002	인사팀	Human resources	그렙타워 4층
D0003	총무팀	General Affairs	그렙타워 4층

//HR_EMPLOYEES
EMP_NO	EMP_NAME	DEPT_ID	POSITION	EMAIL	COMP_TEL	HIRE_DATE	SAL
2017002	정호식	D0001	팀장	hosick_jung@grepp.com	031-8000-1101	2017-03-01	65000000
2018001	김민석	D0001	팀원	minseock_kim@grepp.com	031-8000-1102	2018-03-01	60000000
2019001	김솜이	D0002	팀장	somi_kim@grepp.com	031-8000-1106	2019-03-01	60000000
2020002	김연주	D0002	팀원	yeonjoo_kim@grepp.com	031-8000-1107	2020-03-01	53000000
2020005	양성태	D0003	팀원	sungtae_yang@grepp.com	031-8000-1112	2020-03-01	53000000

//HR_GRADE
EMP_NO	YEAR	HALF_YEAR	SCORE
2017002	2022	1	92
2018001	2022	1	89
2019001	2022	1	94
2020002	2022	1	90
2020005	2022	1	92
2017002	2022	2	84
2018001	2022	2	89
2019001	2022	2	81
2020002	2022	2	91
2020005	2022	2	81
*/

/*출력
*/

WITH SUM_SCORE AS (
    SELECT SUM(SCORE) AS SCORE, EMP_NO
    FROM HR_GRADE
    GROUP BY EMP_NO
)

SELECT B.SCORE AS SCORE, 
    A.EMP_NO AS EMP_NO,
    A.EMP_NAME AS EMP_NAME,
    A.POSITION AS POSITION,
    A.EMAIL AS EMAIL
    
FROM HR_EMPLOYEES AS A
JOIN SUM_SCORE AS B
ON A.EMP_NO = B.EMP_NO
WHERE B.SCORE = (SELECT MAX(SCORE)
    FROM SUM_SCORE)



```